<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>J & V — Invitación de Boda</title>

  <style>
:root{
  --bGold: rgba(201,151,43,.34);
  --bChamp: rgba(241,209,138,.32);
  --bCream: rgba(255,248,235,.34);
  --bWhite: rgba(255,255,255,.26);
}

    *{ box-sizing:border-box; }
    img{ max-width:100%; height:auto; }

    html, body{
      width:100%;
      height:100%;
      margin:0;
    }

    body{
      display:grid;
      place-items:center;

      min-height:100vh;
      min-height:100svh;
      min-height:100dvh;

      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#fff;
      overflow:hidden;
      padding:18px;
      text-align:center;
      color:#222;
      position:relative;
    }

    .bg-base{
      position:fixed;
      inset:0;
      z-index:0;
      background: linear-gradient(135deg,
        #ffffff 0%,
        #fff6e6 25%,
        #f1d18a 55%,
        #fffaf1 80%,
        #ffffff 100%);
      background-size:300% 300%;
      animation: baseMove 7s ease-in-out infinite;
      pointer-events:none;
    }

    /* ✅ Canvas visible (sin soft-light que lo “apaga” en fondos claros) */
    #bubblesCanvas{
      position:fixed;
      inset:0;
      z-index:1;
      pointer-events:none;

      display:block;
      opacity:0.90;              /* ✅ más visible */
      mix-blend-mode: normal;     /* ✅ clave: evita que desaparezcan */
      filter: saturate(1.10) contrast(1.10);
    }

    .shimmer{
      position:fixed;
      inset:-25%;
      z-index:2;
      pointer-events:none;
      background: linear-gradient(115deg,
        rgba(255,255,255,0) 0%,
        rgba(241,209,138,.65) 45%,
        rgba(255,255,255,0) 60%
      );
      filter: blur(10px);
      opacity:.5;
      animation: shimmerMove 7s ease-in-out infinite;
    }

    @keyframes baseMove{
      0%{ background-position:0% 50%; }
      50%{ background-position:100% 50%; }
      100%{ background-position:0% 50%; }
    }

    @keyframes shimmerMove{
      0%{ transform:translateX(-40%) rotate(6deg); }
      50%{ transform:translateX(10%) rotate(6deg); }
      100%{ transform:translateX(45%) rotate(6deg); }
    }

    /* ✅ portada: SOLO la imagen Sobre.png */
    .cover{
      width: min(720px, 92vw);
      max-height: 86svh;
      max-height: 86dvh;
      height: auto;

      display:block;
      cursor:pointer;
      user-select:none;
      -webkit-user-drag:none;

      filter: drop-shadow(0 18px 35px rgba(0,0,0,.16));
      transition: transform .25s ease, filter .25s ease;
    }

    @media (min-width: 900px){
      .cover{
        width: clamp(468px, 34vw, 684px);
        max-height: 82vh;
      }
    }

    @media (max-width: 520px){
      .cover{
        width: 92vw;
        max-height: 84svh;
        max-height: 84dvh;
      }
    }

    .cover-wrap{
      position: relative;
      display: grid;
      place-items: center;
      z-index:10; /* ✅ arriba del canvas */
    }

    .hint{
      position: absolute;
      left: 50%;
      bottom: 6%;
      transform: translateX(-50%);
      width: 92%;
      max-width: 520px;

      font-size: 1.15rem;
      letter-spacing: 1.6px;
      color: rgba(80,80,80,.72);
      text-transform: uppercase;

      opacity: 0;
      animation: hintIn .7s ease forwards;
      animation-delay: 1s;

      pointer-events: none;
      user-select: none;
    }

    @keyframes hintIn{
      from{ opacity:0; transform: translateX(-50%) translateY(6px); }
      to  { opacity:1; transform: translateX(-50%) translateY(0); }
    }

    @media (max-width: 520px){
      .hint{
        bottom: 7%;
        font-size: .95rem;
        letter-spacing: 1.2px;
      }
    }
  </style>
</head>

<body>
  <div class="bg-base"></div>
  <canvas id="bubblesCanvas"></canvas>
  <div class="shimmer"></div>

  <div class="cover-wrap">
    <img src="assets/Sobre.png" alt="Sobre" class="cover" id="cover" />
    <div class="hint" id="hint">Toca el sobre para abrir</div>
  </div>

  <!-- ✅ MÚSICA: sin mover ni cambiar rutas -->
  <audio id="bg-music" preload="auto">
    <source src="assets/MusicaparaBoda.m4a" type="audio/mp4">
    Tu navegador no soporta audio.
  </audio>

  <script>
    const cover = document.getElementById("cover");
    const music = document.getElementById("bg-music");

    cover.addEventListener("click", async () => {
      try {
        const hint = document.getElementById("hint");
        if (hint) hint.style.display = "none";
        if (!music.paused) return;
        await music.play();
      } catch (e) {
        console.error("No se pudo reproducir. Verifica el archivo en /assets.", e);
      }
    });

    /* =========================================================
       ✅ Burbujas en Canvas (visible y rebote estable)
       ========================================================= */
    const reduceMotion = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

    if (!reduceMotion) {
      const canvas = document.getElementById("bubblesCanvas");
      const ctx = canvas.getContext("2d", { alpha:true });

      function rand(min, max){ return Math.random() * (max - min) + min; }

      function getVP(){
        const vv = window.visualViewport;
        const w = Math.round(vv ? vv.width  : document.documentElement.clientWidth);
        const h = Math.round(vv ? vv.height : document.documentElement.clientHeight);
        return { w, h };
      }

      let vp = getVP();
      let dpr = Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));

      const bubbles = [];
      const COUNT = 18;

      function resizeCanvas(){
        vp = getVP();
        dpr = Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));

        canvas.style.width = vp.w + "px";
        canvas.style.height = vp.h + "px";

        canvas.width = Math.floor(vp.w * dpr);
        canvas.height = Math.floor(vp.h * dpr);

        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        // clamp para que no queden fuera
        for (const b of bubbles){
          b.x = Math.min(b.x, Math.max(0, vp.w - b.size));
          b.y = Math.min(b.y, Math.max(0, vp.h - b.size));
        }
      }

      function makeBubble(){
        const size = rand(60, 200);
        const r = Math.random();
        const kind = (r < 0.34) ? "gold" : (r < 0.67) ? "cream" : "white";

        // ✅ alphas más altos para que se vean
        let alpha = (kind === "gold") ? rand(0.45, 0.85)
                  : (kind === "cream") ? rand(0.35, 0.70)
                  : rand(0.28, 0.60);

        const angle = rand(0, Math.PI * 2);
        const speed = rand(10, 26);
        const vx = Math.cos(angle) * speed;
        const vy = Math.sin(angle) * speed;

        return {
          kind,
          size,
          x: rand(0, Math.max(0, vp.w - size)),
          y: rand(0, Math.max(0, vp.h - size)),
          vx, vy,
          ax: 0, ay: 0,
          steerLeft: rand(0.6, 1.4),
          alpha
        };
      }

      resizeCanvas();

      for (let i=0; i<COUNT; i++) bubbles.push(makeBubble());

      function drawBubble(b){
        const x = b.x + b.size * 0.5;
        const y = b.y + b.size * 0.5;
        const r = b.size * 0.5;

        const hx = x - r * 0.22;
        const hy = y - r * 0.22;

        const g = ctx.createRadialGradient(hx, hy, r * 0.10, x, y, r);

        if (b.kind === "gold"){
          g.addColorStop(0.00, `rgba(255,255,255,${0.65 * b.alpha})`);
          g.addColorStop(0.30, `rgba(241,209,138,${0.75 * b.alpha})`);
          g.addColorStop(0.62, `rgba(201,151,43,${0.80 * b.alpha})`);
          g.addColorStop(0.82, `rgba(160,115,25,${0.35 * b.alpha})`);
          g.addColorStop(1.00, `rgba(255,255,255,0)`);
        } else if (b.kind === "cream"){
          g.addColorStop(0.00, `rgba(255,255,255,${0.55 * b.alpha})`);
          g.addColorStop(0.60, `rgba(255,248,235,${0.85 * b.alpha})`);
          g.addColorStop(1.00, `rgba(255,255,255,0)`);
        } else {
          g.addColorStop(0.00, `rgba(255,255,255,${0.50 * b.alpha})`);
          g.addColorStop(0.65, `rgba(255,255,255,${0.35 * b.alpha})`);
          g.addColorStop(1.00, `rgba(255,255,255,0)`);
        }

        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(x, y, r, 0, Math.PI * 2);
        ctx.fill();

        // borde sutil
        ctx.strokeStyle = `rgba(255,255,255,${0.18 * b.alpha})`;
        ctx.lineWidth = 1;
        ctx.stroke();
      }

      function onResizeLike(){ resizeCanvas(); }

      window.addEventListener("resize", onResizeLike, { passive:true });
      window.addEventListener("orientationchange", onResizeLike, { passive:true });
      if (window.visualViewport){
        window.visualViewport.addEventListener("resize", onResizeLike, { passive:true });
        window.visualViewport.addEventListener("scroll", onResizeLike, { passive:true });
      }

      let last = performance.now();

      function tick(now){
        const dt = Math.min(0.033, (now - last) / 1000);
        last = now;

        ctx.clearRect(0, 0, vp.w, vp.h);

        for (const b of bubbles){
          b.steerLeft -= dt;
          if (b.steerLeft <= 0){
            b.steerLeft = rand(0.6, 1.4);
            b.ax = rand(-18, 18);
            b.ay = rand(-18, 18);
          }

          b.vx += b.ax * dt;
          b.vy += b.ay * dt;

          const vmax = 32;
          const v = Math.hypot(b.vx, b.vy) || 1;
          if (v > vmax){
            b.vx = (b.vx / v) * vmax;
            b.vy = (b.vy / v) * vmax;
          }

          b.x += b.vx * dt;
          b.y += b.vy * dt;

          const maxX = Math.max(0, vp.w - b.size);
          const maxY = Math.max(0, vp.h - b.size);

          if (b.x <= 0){ b.x = 0; b.vx = Math.abs(b.vx); }
          if (b.x >= maxX){ b.x = maxX; b.vx = -Math.abs(b.vx); }
          if (b.y <= 0){ b.y = 0; b.vy = Math.abs(b.vy); }
          if (b.y >= maxY){ b.y = maxY; b.vy = -Math.abs(b.vy); }

          drawBubble(b);
        }

        requestAnimationFrame(tick);
      }

      requestAnimationFrame(tick);
    }
  </script>
</body>
</html>
