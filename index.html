<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>J & V — Invitación de Boda</title>

  <style>
:root{
  --bGold: rgba(201,151,43,.34);
  --bChamp: rgba(241,209,138,.32);
  --bCream: rgba(255,248,235,.34);
  --bWhite: rgba(255,255,255,.26);
}

    *{ box-sizing:border-box; }

    img{ max-width:100%; height:auto; }

    html, body{
      width:100%;
      height:100%;
      margin:0;
    }

    body{
      display:grid;
      place-items:center;

      min-height:100vh;
      min-height:100svh;
      min-height:100dvh;

      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      /* ✅ IMPORTANTE: el fondo lo pone .bg-base, aquí lo dejamos transparente
         para evitar problemas de stacking con z-index negativos */
      background: transparent;

      overflow:hidden;
      padding:18px;
      text-align:center;
      color:#222;

      /* ✅ crea un stacking context limpio */
      position: relative;
    }

    .bg-base{
      position:fixed;
      inset:0;
      z-index:0; /* ✅ antes -4 */
      background: linear-gradient(135deg,
        #ffffff 0%,
        #fff6e6 25%,
        #f1d18a 55%,
        #fffaf1 80%,
        #ffffff 100%);
      background-size:300% 300%;
      animation: baseMove 7s ease-in-out infinite;
      pointer-events:none;
    }

    .bubbles{
      position:fixed;
      inset:0;
      z-index:1; /* ✅ antes -3 */
      pointer-events:none;
      overflow:hidden;
    }

    .bubbles2{
      position:fixed;
      inset:0;
      z-index:2; /* ✅ antes -2 */
      pointer-events:none;
      overflow:hidden;
      mix-blend-mode: soft-light;
      filter: saturate(1.05) contrast(1.06);
    }

    .bubble{
      position:absolute;
      border-radius:999px;
      pointer-events:none;
      will-change: transform;
      transform: translate3d(0,0,0);

      border: 1px solid rgba(255,255,255,.16);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.08),
        inset 0 18px 30px rgba(255,255,255,.10),
        0 8px 22px rgba(0,0,0,.06);
      backdrop-filter: blur(2px);
      -webkit-backdrop-filter: blur(2px);
    }

    .bubble.gold{
      background: radial-gradient(circle at 30% 30%,
        rgba(255,255,255,.55) 0%,
        rgba(241,209,138,.45) 30%,
        rgba(201,151,43,.35) 62%,
        rgba(160,115,25,.18) 78%,
        rgba(255,255,255,0) 100%);
      filter: saturate(1.12) brightness(1.03);
    }

    .bubble.cream{
      background: radial-gradient(circle at 30% 30%,
        rgba(255,255,255,.42) 0%,
        var(--bCream) 58%,
        rgba(255,255,255,0) 100%);
    }

    .bubble.white{
      background: radial-gradient(circle at 30% 30%,
        rgba(255,255,255,.35) 0%,
        var(--bWhite) 62%,
        rgba(255,255,255,0) 100%);
    }

    .shimmer{
      position:fixed;
      inset:-25%;
      z-index:3; /* ✅ antes -1 */
      pointer-events:none;
      background: linear-gradient(115deg,
        rgba(255,255,255,0) 0%,
        rgba(241,209,138,.65) 45%,
        rgba(255,255,255,0) 60%
      );
      filter: blur(10px);
      opacity:.5;
      animation: shimmerMove 7s ease-in-out infinite;
    }

    @keyframes baseMove{
      0%{ background-position:0% 50%; }
      50%{ background-position:100% 50%; }
      100%{ background-position:0% 50%; }
    }

    @keyframes shimmerMove{
      0%{ transform:translateX(-40%) rotate(6deg); }
      50%{ transform:translateX(10%) rotate(6deg); }
      100%{ transform:translateX(45%) rotate(6deg); }
    }

    .cover{
      width: min(720px, 92vw);
      max-height: 86svh;
      max-height: 86dvh;
      height: auto;

      display:block;
      cursor:pointer;
      user-select:none;
      -webkit-user-drag:none;

      filter: drop-shadow(0 18px 35px rgba(0,0,0,.16));
      transition: transform .25s ease, filter .25s ease;
    }

    @media (min-width: 900px){
      .cover{
        width: clamp(468px, 34vw, 684px);
        max-height: 82vh;
      }
    }

    @media (max-width: 520px){
      .cover{
        width: 92vw;
        max-height: 84svh;
        max-height: 84dvh;
      }
    }

    .cover-wrap{
      position: relative;
      display: grid;
      place-items: center;
      z-index:10; /* ✅ asegura que esté encima de las burbujas */
    }

    .hint{
      position: absolute;
      left: 50%;
      bottom: 6%;
      transform: translateX(-50%);
      width: 92%;
      max-width: 520px;

      font-size: 1.15rem;
      letter-spacing: 1.6px;
      color: rgba(80,80,80,.72);
      text-transform: uppercase;

      opacity: 0;
      animation: hintIn .7s ease forwards;
      animation-delay: 1s;

      pointer-events: none;
      user-select: none;
    }

    @keyframes hintIn{
      from{ opacity:0; transform: translateX(-50%) translateY(6px); }
      to  { opacity:1; transform: translateX(-50%) translateY(0); }
    }

    @media (max-width: 520px){
      .hint{
        bottom: 7%;
        font-size: .95rem;
        letter-spacing: 1.2px;
      }
    }

  </style>
</head>

<body>
  <div class="bg-base"></div>
  <div class="bubbles"></div>
  <div class="bubbles2"></div>
  <div class="shimmer"></div>

  <div class="cover-wrap">
    <img src="assets/Sobre.png" alt="Sobre" class="cover" id="cover" />
    <div class="hint" id="hint">Toca el sobre para abrir</div>
  </div>

  <!-- ✅ MÚSICA: sin mover ni cambiar rutas -->
  <audio id="bg-music" preload="auto">
    <source src="assets/MusicaparaBoda.m4a" type="audio/mp4">
    Tu navegador no soporta audio.
  </audio>

  <script>
    const cover = document.getElementById("cover");
    const music = document.getElementById("bg-music");

    cover.addEventListener("click", async () => {
      try {
        const hint = document.getElementById("hint");
        if (hint) hint.style.display = "none";
        if (!music.paused) return;
        await music.play();
      } catch (e) {
        console.error("No se pudo reproducir. Verifica el archivo en /assets.", e);
      }
    });

    const reduceMotion = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    if (!reduceMotion) {
      const layer1 = document.querySelector(".bubbles");
      const layer2 = document.querySelector(".bubbles2");

      const SPEED_1 = 26;
      const SPEED_2 = 18;

      function rand(min, max){ return Math.random() * (max - min) + min; }

      function makeBubble(parent, kind, sizeMin, sizeMax, opMin, opMax){
        const el = document.createElement("span");
        el.className = `bubble ${kind}`;
        parent.appendChild(el);

        const size = rand(sizeMin, sizeMax);
        el.style.width = `${size}px`;
        el.style.height = `${size}px`;

        let op = rand(opMin, opMax);
        if (kind === "gold") op = Math.min(0.70, op * 1.25);
        if (kind === "white") op = op * 0.90;
        el.style.opacity = op.toFixed(2);

        const b = {
          el,
          size,
          px: 0,
          py: 0,
          vx: rand(-1, 1),
          vy: rand(-1, 1),
          ax: 0,
          ay: 0,
          steerLeft: rand(0.6, 1.4)
        };

        const mag = Math.hypot(b.vx, b.vy) || 1;
        b.vx /= mag; b.vy /= mag;

        return b;
      }

      /* ✅ FIX: usar layout viewport real (más estable en WebViews) */
      function viewportBounds(){
        const root = document.documentElement;
        return { w: root.clientWidth, h: root.clientHeight };
      }

      function setup(parent, count, palette, sizeMin, sizeMax, opMin, opMax, W, H){
        const arr = [];
        for (let i=0; i<count; i++){
          const kind = palette[(Math.random() * palette.length) | 0];
          const b = makeBubble(parent, kind, sizeMin, sizeMax, opMin, opMax);
          b.px = rand(0, Math.max(0, W - b.size));
          b.py = rand(0, Math.max(0, H - b.size));
          arr.push(b);
        }
        return arr;
      }

      let b1 = viewportBounds();
      let b2 = viewportBounds();

      const bubbles1 = setup(layer1, 10, ["gold","cream","white"], 80, 200, 0.24, 0.46, b1.w, b1.h);
      const bubbles2 = setup(layer2, 8,  ["gold","cream","white"], 60, 160, 0.18, 0.36, b2.w, b2.h);

      function clampAll(){
        for (const b of bubbles1){
          b.px = Math.min(b.px, Math.max(0, b1.w - b.size));
          b.py = Math.min(b.py, Math.max(0, b1.h - b.size));
        }
        for (const b of bubbles2){
          b.px = Math.min(b.px, Math.max(0, b2.w - b.size));
          b.py = Math.min(b.py, Math.max(0, b2.h - b.size));
        }
      }

      function onResizeLike(){
        b1 = viewportBounds();
        b2 = viewportBounds();
        clampAll();
      }

      window.addEventListener("resize", onResizeLike, { passive:true });
      window.addEventListener("orientationchange", onResizeLike, { passive:true });

      let last = performance.now();

      function tick(now){
        const dt = Math.min(0.033, (now - last) / 1000);
        last = now;

        function update(arr, speed, BW, BH){
          for (const b of arr){
            b.steerLeft -= dt;
            if (b.steerLeft <= 0){
              b.steerLeft = rand(0.6, 1.4);
              b.ax = rand(-0.9, 0.9);
              b.ay = rand(-0.9, 0.9);
            }

            b.vx += b.ax * dt * 0.6;
            b.vy += b.ay * dt * 0.6;

            const mag = Math.hypot(b.vx, b.vy) || 1;
            b.vx /= mag; b.vy /= mag;

            b.px += b.vx * speed * dt;
            b.py += b.vy * speed * dt;

            const maxX = Math.max(0, BW - b.size);
            const maxY = Math.max(0, BH - b.size);

            if (b.px <= 0){ b.px = 0; b.vx = Math.abs(b.vx); }
            if (b.px >= maxX){ b.px = maxX; b.vx = -Math.abs(b.vx); }
            if (b.py <= 0){ b.py = 0; b.vy = Math.abs(b.vy); }
            if (b.py >= maxY){ b.py = maxY; b.vy = -Math.abs(b.vy); }

            b.el.style.transform = `translate3d(${b.px}px, ${b.py}px, 0)`;
          }
        }

        update(bubbles1, SPEED_1, b1.w, b1.h);
        update(bubbles2, SPEED_2, b2.w, b2.h);

        requestAnimationFrame(tick);
      }

      requestAnimationFrame(tick);
    }
  </script>
</body>
</html>
